<wm-uploader></wm-uploader>
<!-- <ion-select >
    <ion-option value="f">Female</ion-option>
    <ion-option value="m">Male</ion-option>
</ion-select> -->
<button (click)="dataService.startProcessing(true)">Start</button>
<button (click)="dataService.stopProcessing()">Stop </button>
<ion-list lines="none">
    <ion-list-header>
        <ion-item>
            <ion-label>Sort Method</ion-label>
            <ion-select (ionChange)="sort($event.target.value)" [value]="sortMethods[currentSortMethod].label" [placeholder]="sortMethods[currentSortMethod].label | translate">
                <ion-select-option *ngFor="let method of sortMethods; index as sortIndex" [value]="sortIndex">{{method.label | translate}}</ion-select-option>
            </ion-select>
        </ion-item>
    </ion-list-header>

    <ion-item-sliding *ngFor="let file of files | filter:'recentlyUploaded':false; index as i; ">
        <ion-item>

            <ion-label>
                <div class="fileInfoBar" [ngClass]="{recentlyUploaded: file.recentlyUploaded, 
                    loading: !file.complete, 
                    inPlayer: (file === currentLoadedFile ), 
                    canBePlayed: file.objectURL,
                    loaded: file.complete
                }">
                    <div class="image">
                        <img [src]="file.picture" *ngIf="file.picture" [alt]="file.tags.tags.title" />
                        <ion-icon name="image" *ngIf="!file.picture"></ion-icon>
                    </div>
                    <div *ngIf="file.tags" class="tags" (click)="playFile(i)">
                        <span class="title"><b>{{ file.tags.tags.title }}</b> - {{ file.tags.tags.artist }}</span>
                        <!-- <span class="sub"><ion-icon name="microphone"></ion-icon>  {{ (file.tags.tags.year) ? file.tags.tags.year : "????" }} </span> -->
                        <span class="sub"><ion-icon name="disc"></ion-icon> {{ (file.tags.tags.album) ? file.tags.tags.album : ("TDI.UNKNOWN" | translate ) }} </span>
                        <span class="sub"><ion-icon name="calendar"></ion-icon> {{ (file.tags.tags.year) ? file.tags.tags.year : "????" }} </span>
                    </div>
                    <div *ngIf="!file.tags" class="tags" (click)="playFile(i)">
                        <span class="title">{{file.file.name}}</span>
                    </div>
                    <wm-waveform [data]="file.waveform" (click)="playFile(i)"></wm-waveform>
                    <div class="bpm">
                        <span class="value" *ngIf="!file.bpm"><ion-spinner></ion-spinner></span>
                        <span class="value" *ngIf="file.bpm">{{file.bpm.groups[0].tempo}}</span>
                        <span>BPM</span>
                    </div>
                    <div class="recentlyUploaded" *ngIf="file.recentlyUploaded">
                        <ion-icon name="clock"></ion-icon>
                    </div>
                </div>
            </ion-label>

        </ion-item>
        <ion-item-options side="end">
            <ion-item-option (click)="setFavorite(i)">Favorite</ion-item-option>
            <ion-item-option color="danger" (click)="removeFile(i)">Delete</ion-item-option>
        </ion-item-options>
    </ion-item-sliding>

    <!-- <ion-item *ngFor="let file of files; index as i; " (click)="playFile(i)">
        <ion-spinner *ngIf="!file.complete"></ion-spinner>
        <ion-label *ngIf="file.complete">
            <ion-icon slot="start" color="medium" [name]="file.complete ? 'play' : 'infinite'"></ion-icon>
        </ion-label>
        <ion-label>{{file.file.name}}</ion-label>
        <ion-label>{{ file.complete }} </ion-label>
        <ion-label>
            <wm-waveform [data]="file.waveform"></wm-waveform>
        </ion-label>
        <ion-label *ngIf="file.bpm">BPM: {{file.bpm.groups[0].tempo}}</ion-label>

        <ion-label *ngIf="!file.bpm">Loading...</ion-label>
    </ion-item> -->

</ion-list>